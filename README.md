# KuaiJi 使用手册

## 📱 应用简介

**KuaiJi（快记）** 是一款多人共享账本应用，支持多人 AA 分账、自动结算和设备间数据同步。

**支持语言**：中文、English、Français

---

## 🚀 使用流程

### 1️⃣ 首次设置
- 输入姓名
- 选择常用货币（CNY/USD/EUR）
- 选择头像 emoji
- 点击右上角"开始使用"

### 2️⃣ 添加朋友（可选）
**三种方式：**
- 📝 手动输入：姓名、头像、货币
- 📷 扫码添加：扫描朋友的二维码
- 🎫 展示二维码：让朋友扫描添加

### 3️⃣ 创建账本
1. 点击账本页右上角"+"
2. 输入账本名称
3. 选择货币类型
4. 选择成员（至少包含自己）
5. 点击"创建"

### 4️⃣ 记录支出
1. 进入账本，点击右上角"+"
2. 填写支出信息：
   - 用途（如：晚餐、打车）
   - 金额
   - 日期
   - 分类（餐饮/交通/住宿/娱乐/日用/其他）
3. 选择分账方式：
   - **我请客 AA**：我付款，大家均摊（含我）
   - **别人请客 AA**：别人付款，大家均摊
   - **我请客**：我全额付款，不分摊
   - **别人请客**：别人全额付款，不分摊
   - **帮别人付**：代付/垫付场景
4. 查看支付预览，确认保存

### 5️⃣ 查看结算
**账本详情页包含：**
- 📊 总支出
- 👥 成员支出（默认显示 4 人，点击"全部"查看更多）
- 💰 净额（谁欠谁多少）
- 📝 流水记录（最近 3 条，点击"全部"查看所有）
- 💸 转账方案（最少转账次数的结算方案）

### 6️⃣ 结算清账
1. 查看转账方案
2. 线下转账完成
3. 点击"清账"按钮
4. 系统自动记录结算流水，净额归零

### 7️⃣ 共享账本（可选）
**📡 附近设备同步：**
1. 点击账本页左上角"📡 共享账本"
2. 自动搜索附近设备
3. 选择设备并连接
4. 点击"开始同步"
5. 双向同步完成

**⚠️ 同步规则：**
- 硬合并所有记录（不去重）
- 只同步相关账本（成员包含自己的账本）
- 自动添加新朋友
- 不同步清账记录

---

## 🎯 核心功能

### 账本管理
- ✅ 创建多个账本
- ✅ 支持多货币（CNY/USD/EUR等）
- ✅ 多成员协作
- ✅ 滑动删除账本

### 支出记录
- ✅ 快速记账
- ✅ 6 大分类
- ✅ 多种分账方式
- ✅ 实时计算分摊

### 自动结算
- ✅ 实时净额计算
- ✅ 最少转账方案
- ✅ 一键清账
- ✅ 结算历史记录

### 朋友管理
- ✅ 手动添加
- ✅ 二维码扫描
- ✅ 编辑朋友信息
- ✅ 删除朋友

### 数据同步
- ✅ MultipeerConnectivity（蓝牙/WiFi）
- ✅ 自动设备发现
- ✅ 双向同步
- ✅ 智能合并

### 个人设置
- ✅ 修改个人信息
- ✅ 多语言切换（跟随系统）
- ✅ 清除所有数据

---

## 📊 界面导航

### 主界面（底部 Tab）
1. **账本**：管理所有共享账本
2. **朋友**：管理联系人
3. **设置**：个人资料、数据管理

### 账本详情
- **总支出**：账本总金额
- **成员支出**：每个人的支出明细
- **净额**：欠款/收款金额
- **流水记录**：所有支出明细
- **转账方案**：最优结算建议

---

## 💡 使用技巧

1. **快速记账**：点击空白处收起键盘
2. **查看明细**：点击"全部"按钮展开完整列表
3. **分账预览**：添加支出时可预览每人应付金额
4. **定期清账**：避免累计金额过大
5. **同步前确认**：确保不会重复记录同一笔支出

---

## ⚙️ 技术特性

- 🔒 本地数据存储（SwiftData）
- 🎨 原生 SwiftUI 界面
- 📱 支持 iPhone 和 iPad
- 🌐 完整国际化支持
- 🔄 自动结算算法
- 📡 近场设备发现

---

## 📝 注意事项

1. **货币一致性**：账本内建议使用统一货币
2. **同步警告**：同步会硬合并，重复记录无法自动去重
3. **清账记录**：清账后会生成结算流水，不可撤销
4. **数据备份**：定期通过设备同步备份数据

---

**版本**：1.0  
**平台**：iOS 16.0+  
**开发**：SwiftUI + SwiftData


